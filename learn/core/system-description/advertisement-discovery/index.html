<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../../../img/favicon.ico">

  <title>Advertisement discovery - SmartConn</title>

  <link href="../../../../css/bootstrap-custom.min.css" rel="stylesheet">
  <link href="../../../../css/font-awesome-4.0.3.css" rel="stylesheet">
  <link href="../../../../css/highlight.css" rel="stylesheet">
  <link href="../../../../css/base.css" rel="stylesheet">
  <link href="../../../../css/smartconn.css" rel="stylesheet">

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
  <![endif]-->

  
</head>

<body>
  <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">

    <!-- Collapsed navigation -->
    <div class="navbar-header">
      <!-- Expander button -->
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <!-- Main title -->
      <a class="navbar-brand" href="/">SmartConn</a>
    </div>

    <!-- Expanded navigation -->
    <div class="navbar-collapse collapse">
      <!-- Main navigation -->
      <ul class="nav navbar-nav">
        <li class="active">
          <a href="../../../..">Docs</a>
        </li>
      </ul>

      <!-- Search, Navigation and Repo links -->
      <ul class="nav navbar-nav navbar-right">
        

        <!-- user -->
        <li><a href="#">My Apps</a></li>
      </ul>
    </div>
  </div>
</div>

  <div class="container">
    <div class="col-md-3"><div class="bs-sidebar hidden-print" role="complementary">
  <ul class="nav bs-sidenav">
    
      
  

    
      
  <li class="">
    
      
        <a href="../../../../ambassadors/">Ambassadors</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

    
      
  <li class="">
    
      
        <a href="../../../../develop/">Develop</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  <li class="">
    
      
        <a href="../../../../develop/api-guide/">Api guide</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  <li class="">
    
      
    
      
    
      
    
      
        <a href="../../../../develop/api-guide/about/">About</a>
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/about/c-thin/">C thin</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/about/cpp-legacy/">Cpp legacy</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/about/cpp/">Cpp</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/about/java-legacy/">Java legacy</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/about/java/">Java</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/about/objc-legacy/">Objc legacy</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/about/objc/">Objc</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/api-guide/audio-streaming/">Audio streaming</a>
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/audio-streaming/cpp/">Cpp</a>
    </li>
  

        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
    
      
        <a href="../../../../develop/api-guide/config/">Config</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/config/c-thin/">C thin</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/config/cpp/">Cpp</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/config/java/">Java</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/config/objc/">Objc</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
    
      
        <a href="../../../../develop/api-guide/controlpanel/">Controlpanel</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/controlpanel/c-thin/">C thin</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/controlpanel/cpp/">Cpp</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/controlpanel/java/">Java</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/controlpanel/objc/">Objc</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/api-guide/core/">Core</a>
      
    
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/core/alljoyn-transports-best-practices/">Alljoyn transports best practices</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/core/java/">Java</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/core/objc/">Objc</a>
    </li>
  

        
          
  <li class="">
    
      
        <a href="../../../../develop/api-guide/core/auto-ping/">Auto ping</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/api-guide/core/observer/">Observer</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/api-guide/core/propcache/">Propcache</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/api-guide/events-and-actions/">Events and actions</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
    
      
        <a href="../../../../develop/api-guide/notification/">Notification</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/notification/c-thin/">C thin</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/notification/cpp/">Cpp</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/notification/java/">Java</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/notification/objc/">Objc</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/api-guide/onboarding/">Onboarding</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/onboarding/java/">Java</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/api-guide/onboarding/objc/">Objc</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/api-reference/">Api reference</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/ask/">Ask</a>
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/ask/popular/">Popular</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/building/">Building</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/building/thin-linux/">Thin linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/building/thin-windows/">Thin windows</a>
    </li>
  

        
          
  <li class="">
    
      
        <a href="../../../../develop/building/alljoyn-js/">Alljoyn js</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/building/android/">Android</a>
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/building/android/build-source/">Build source</a>
    </li>
  

        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/building/ios-osx/">Ios osx</a>
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/building/ios-osx/build-source/">Build source</a>
    </li>
  

        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/building/linux/">Linux</a>
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/building/linux/build-source/">Build source</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/building/linux/openwrt/">Openwrt</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/building/windows/">Windows</a>
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/building/windows/build-source/">Build source</a>
    </li>
  

        
          
  

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/debug/">Debug</a>
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/debug/common-issues/">Common issues</a>
    </li>
  

        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/run-sample-apps/">Run sample apps</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  <li class="">
    
      
        <a href="../../../../develop/run-sample-apps/about/">About</a>
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/about/ios-osx/">Ios osx</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/about/linux/">Linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/about/windows/">Windows</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/run-sample-apps/acserver/">Acserver</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/acserver/linux/">Linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/acserver/thin-linux/">Thin linux</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/run-sample-apps/alljoyn-js/">Alljoyn js</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/run-sample-apps/basic/">Basic</a>
      
    
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/basic/android/">Android</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/basic/ios-osx/">Ios osx</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/basic/linux/">Linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/basic/thin-linux/">Thin linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/basic/thin-windows/">Thin windows</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/basic/windows/">Windows</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/run-sample-apps/chat/">Chat</a>
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/chat/android/">Android</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/chat/ios-osx/">Ios osx</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/chat/linux/">Linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/chat/thin-linux/">Thin linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/chat/windows/">Windows</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/run-sample-apps/config/">Config</a>
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/config/android/">Android</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/config/ios-osx/">Ios osx</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/config/linux/">Linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/config/thin-linux/">Thin linux</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/run-sample-apps/controlpanel/">Controlpanel</a>
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/controlpanel/android/">Android</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/controlpanel/ios-osx/">Ios osx</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/controlpanel/linux/">Linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/controlpanel/thin-linux/">Thin linux</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/run-sample-apps/notification/">Notification</a>
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/notification/android/">Android</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/notification/ios-osx/">Ios osx</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/notification/linux/">Linux</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/notification/thin-linux/">Thin linux</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/run-sample-apps/observer/">Observer</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/run-sample-apps/onboarding/">Onboarding</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/onboarding/android/">Android</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/onboarding/ios-osx/">Ios osx</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/onboarding/linux/">Linux</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../../develop/run-sample-apps/test/">Test</a>
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/run-sample-apps/test/sessions/">Sessions</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../../../develop/tutorial/">Tutorial</a>
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../../develop/tutorial/arduino-and-gt202/">Arduino and gt202</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../../develop/tutorial/ios/">Ios</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/tutorial/thin-app/">Thin app</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../../develop/tutorial/videos/">Videos</a>
    </li>
  

        
          
  <li class="">
    
      
        <a href="../../../../develop/tutorial/core/">Core</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

    
      
  <li class="active">
    
      
    
      
    
      
        <a href="../../../">Learn</a>
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../../architecture/">Architecture</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../glossary/">Glossary</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../../use-cases/">Use cases</a>
    </li>
  

        
          
  <li class="">
    
      
        <a href="../../../base-services/">Base services</a>
      
    
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  <li class="">
    
      
        <a href="../../../base-services/audiostreaming/">Audiostreaming</a>
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../base-services/audiostreaming/interface/">Interface</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../base-services/configuration/">Configuration</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../base-services/configuration/interface-14-02/">Interface 14 02</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../base-services/configuration/interface/">Interface</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../base-services/controlpanel/">Controlpanel</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../base-services/controlpanel/interface-14-02/">Interface 14 02</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../base-services/controlpanel/interface/">Interface</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../base-services/notification/">Notification</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../base-services/notification/interface-14-02/">Interface 14 02</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../base-services/notification/interface/">Interface</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../../base-services/onboarding/">Onboarding</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../../base-services/onboarding/interface-14-02/">Interface 14 02</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../../base-services/onboarding/interface/">Interface</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

        
          
  <li class="active">
    
      
    
      
        <a href="../../">Core</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../events-and-actions/">Events and actions</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../../standard-core/">Standard core</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../system-descriptionalljoyn-transport/">System descriptionalljoyn transport</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../thin-core/">Thin core</a>
    </li>
  

        
          
  <li class="">
    
      
        <a href="../../about-announcement/">About announcement</a>
      
    
      
    
      
    
    <ul>
      <div>
        
          
  

        
          
  
    <li class="">
      <a href="../../about-announcement/interface-14-02/">Interface 14 02</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../../about-announcement/interface/">Interface</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
        <a href="../../rn_config/">Rn config</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="">
    
      
    
      
        <a href="../../security2_0/">Security2 0</a>
      
    
    <ul>
      <div>
        
          
  
    <li class="">
      <a href="../../security2_0/hld/">Hld</a>
    </li>
  

        
          
  

        
      </div>
    </ul>
  </li>

        
          
  <li class="active">
    
      
    
      
    
      
    
      
    
      
    
      
        <a href="../">System description</a>
      
    
      
    
      
    
      
    
    <ul>
      <div>
        
          
  
    <li class="active">
      <a href="./">Advertisement discovery</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../alljoyn-security/">Alljoyn security</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../alljoyn-session/">Alljoyn session</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../data-exchange/">Data exchange</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../events-actions/">Events actions</a>
    </li>
  

        
          
  

        
          
  
    <li class="">
      <a href="../sessionless-signal/">Sessionless signal</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../system-architecture/">System architecture</a>
    </li>
  

        
          
  
    <li class="">
      <a href="../thin-apps/">Thin apps</a>
    </li>
  

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

        
      </div>
    </ul>
  </li>

    
      
  <li class="">
    
      
        <a href="../../../../project-lifecycle/">Project lifecycle</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

    
      
  <li class="">
    
      
        <a href="../../../../supported-platforms/">Supported platforms</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

    
      
  <li class="">
    
      
        <a href="../../../../user-groups/">User groups</a>
      
    
    <ul>
      <div>
        
          
  

        
      </div>
    </ul>
  </li>

    
  </ul>
</div></div>
    <div class="col-md-8" role="main">

<h1 id="_1">推广和发现</h1>
<h2 id="_2">概述</h2>
<p>AllJoyn&trade; 系统支持一种可被提供者用于通过 AllJoyn 网络推广服务，同时也可被消费者用于发现并消费这些服务的机制。AllJoyn 支持跨越多种底层
接入网（例如 Wi-Fi）的发现机制。AllJoyn 发现协议的推广和发现功能使用了通过 Wi-Fi 的 IP 多播。发现机制的细节将会对 AllJoyn 应用程序隐藏。</p>
<p>AllJoyn 路由支持为了使用 IP 传输的 Wi-Fi 的指定传输方式的发现机制。</p>
<p>应用程序可以用下列方法中的一种，实现在 AllJoyn 框架上的推广和发现服务。细节讨论在此章节后面的部分。</p>
<ul>
<li>基于 Name: 服务的推广和发现使用一个 well-known name 或者唯一识别符。</li>
<li>基于 Announcement: 服务的推广和发现使用一个 well-known name 或者唯一识别符。 </li>
</ul>
<h3 id="1406">14.06 版本中关于发现功能的增强</h3>
<p>AllJoyn 发现功能在 14.06 版本中有所提升，支持了通过一种更为便捷的方法（NGNS，之前定义的）来发现支持一系列接口的的设备/应用程序。 NGNS 支持
基于 m-DNS 的发现协议，可以在一个 over-the-wire 发现消息中指定 AllJoyn 接口。另外，基于 mDNS 的协议可以提供通过单播的发现回应，以提升发现
协议的性能，将 AllJoyn 发现进程中生成的多播交通总流量降至最低。</p>
<p>通过加入一个通过单播发送的明确的基于 mDNS 的 ping() 消息用来判断远端端点是否活动，目前用于 AllJoyn 设备/应用程序的的探测机制已经被加强。此
ping() 机制由基于自身逻辑的应用程序所驱动。</p>
<p>此章节首先描述了 AllJoyn 历史版本的发现机制（14.06版本之前），随后介绍了基于 NGNS 的发现机制以及当前的发现机制，参见 <a href="#ngns-message-sequences">NGNS 消息序列
</a>.</p>
<h2 id="name">基于 name 的历史版本发现机制</h2>
<p>此章节捕捉了14.06版本之前的历史版本中基于 name 的发现机制设计。</p>
<p>AllJoyn 路由支持一个 Name 服务，从而实现了基于 name 的服务发现模式。Name 服务支持一个基于 UDP 的协议，用于完成通过基于 IP 的接入网（包括 Wi-Fi）的发现工作。基于 Name 的发现的 API 通过 AllJoyn 核心库被暴露。</p>
<p>Name 服务支持 IS-AT 和 WHO-HAS 协议消息，在下面会有他们的描述。这些协议消息携带者将会被推广和发现的 well-known names. 协议消息通过 AllJoyn 近端网络（本地子网）被多播，使用了 IANA-registered IP 多播组以及如下所示的端口名 <a href="#iana-registered-multicast-addresses-for-the-alljoyn-framework">IANA-registered multicast addresses for the AllJoyn framework</a>.</p>
<h3 id="alljoyn-iana-registered">用于 AllJoyn 框架的 IANA-registered 多播地址</h3>
<table>
<thead>
<tr>
<th>Address</th>
<th>Port</th>
</tr>
</thead>
<tbody>
<tr>
<td>IPv4 Multicast group address</td>
<td>224.0.0.113</td>
</tr>
<tr>
<td>IPv6 Multicast group address</td>
<td>FF0X::13A</td>
</tr>
<tr>
<td>Multicast port number</td>
<td>9956</td>
</tr>
</tbody>
</table>
<p>下图捕捉了基于 name 发现机制的高层结构，展示了 Name 服务生成 IS-AT 和 WHO-HAS 消息的过程。</p>
<p><img alt="name-based-discovery-arch" src="../../../../files/learn/system-desc/name-based-discovery-arch.png" /></p>
<p><strong>Figure:</strong> 基于 Name 的发现架构</p>
<h2 id="is-at">IS-AT</h2>
<p>IS-AT 消息通过 well-known name 或者唯一识别符来推广 AllJoyn 服务。一条 IS-AT 消息可以包括包含一个或多个用于推广的 well-known names 或者唯一
识别符的列表。IS-AT 消息通过 Adv_Validity_Period 配置参数为 well-known name 推广指定了一个有效周期。</p>
<p>提供方设备上的 AllJoyn 路由通过 IP 多播周期性地发送 IS-AT 消息，用来推广自己所支持的服务。此周期由提供方上的 Adv_Msg_Retransmit_Interval 可配置参数定义。</p>
<p>IS-AT 消息也可以作为收到的正在寻找服务的 WHO-HAS 消息的回复被发出。借此机制，使用方设备可以被直接提醒，从而最大限度减少了发现过程的时间。</p>
<h3 id="who-has">WHO-HAS</h3>
<p>WHO-HAS 消息可使用 well-known name 或者唯一识别符发现一个或多个 AllJoyn 服务。与 IS-AT 类似，一条 WHO-HAS 消息也包含带有一个或多个用于发现 的 well-known name 或者唯一识别符。WHO-HAS 消息也可以包含一个 well-known name 前缀（取代复杂的 well-known name），可与 IS-AT 消息中所推广的
well-known name 相匹配。</p>
<p>例如，WHO-HAS 消息中的 well-known name 前缀 "org.alljyon.chat" 可以与 IS-AT 消息中推广的 "org.alljoyn.chat._123456.Joe" well-known name 相匹配。</p>
<p>当使用方设备试图发现一个服务时，他会通过 IP 多播发送出 WHO-HAS 消息。此 WHO-HAS 消息将被重复几次，一定概率上引起 Wi-Fi 网络中 collision 的
出现，从而导致多播包数量的减少。</p>
<p>下列参数决定了 WHO-HAS 消息的传输模式：</p>
<ul>
<li>Disc_Msg_Number_Of_Retries</li>
<li>Disc_Msg_Retry_Interval</li>
</ul>
<p>在第一次传输后，每一个 Disc_Msg_Retry_Interval 内 WHO-HAS 消息都会被重新发送 Disc_Msg_Number_Of_Retries 次。作为 WHO-HAS 消息的回应，使用方
可以获取一条由提供方发来的推广了被请求的服务的 IS-AT 消息。</p>
<h3 id="_3">使用方行为</h3>
<p>下图展示了基于 name 发现机制中使用方 AllJoyn 路由的行为：</p>
<p><img alt="consumer-router-discovery-behavior" src="../../../../files/learn/system-desc/consumer-router-discovery-behavior.png" /></p>
<p><strong>Figure:</strong> 使用方 AllJoyn 路由发现行为</p>
<h3 id="_4">消息序列</h3>
<p>在基于 Name 发现的场景中捕捉了下列用例：</p>
<ul>
<li>在 IP 连接已经建立好时发现</li>
<li>不可靠的网络环境下的发现</li>
<li>IP 连接建立延迟的发现</li>
<li>IP 连接丢失导致的 WKN 丢失</li>
<li>提供方取消推广 well-known name</li>
<li>使用方取消发现 well-known name</li>
</ul>
<h4 id="ip">在 IP 连接已经建立好时发现</h4>
<p>下图展示了一个在典型的发现场景中的 AllJoyn 服务 well-known name 的消息序列。在此例中，提供方和使用方设备已经建立了 IP 连接。第一条 WHO-HAS
消息通过 IP 多播已经被传输到提供方设备上，提供方设备随即回复了一条 IS-AT 消息。</p>
<p><img alt="typical-discovery-wkn" src="../../../../files/learn/system-desc/typical-discovery-wkn.png" /></p>
<p><strong>Figure:</strong> 典型的 well-known name 发现</p>
<h4 id="_5">不可靠的网络环境下的发现</h4>
<p>下图展示了在一个底层网络漏掉了一些多播的 WHO-HAS 消息的发现场景中，AllJoyn 服务 well-known name 的消息序列。在这种情况下，WHO-HAS retry 机
制将被触发，消息将根据 Disc_Msg_Number_Of_Retries 和 Disc_Msg_Retry_Interval parameters 两参数来执行重发操作。</p>
<p><img alt="不可靠网络环境下的发现" src="../../../../files/learn/system-desc/discovery-unreliable-network.png" /></p>
<p><strong>Figure:</strong> 不可靠的网络环境下的发现</p>
<h4 id="ip_1">IP 连接建立延迟的发现</h4>
<p>下图展示了在使用方发送完 WHO-HAS 消息之后，连接到 AllJoyn 的近端网络 AP 已延迟的场景中，AllJoyn 服务 well-known name 的消息序列。这种情况在
使用方设备刚刚进入一个新的 AllJoyn 近端网络时可能会发生。子网的 IS-AT 消息已经被使用方的 AllJoyn 路由接收到，并导致了被请求 well-known name
的 FoundAdvertiseName.</p>
<p><img alt="discovery-late-ip-connectivity" src="../../../../files/learn/system-desc/discovery-late-ip-connectivity.png" /></p>
<p><strong>Figure:</strong> IP 连接建立延迟的发现</p>
<h4 id="ip-wkn">IP 连接丢失导致的 WKN 丢失。</h4>
<p>下图展示了在使用方丢失与 AllJoyn 近端网络热点的 IP 连接所导致的 well-known name 丢失的场景中，AllJoyn 服务 well-known name 的消息序列。在使
用方设备离开 AllJoyn 近端网络时可能会发生这种情况。</p>
<p>如果使用方的 AllJoyn 路由在 Adv_Validity_period 时间内没有收到任何给定 well-known name 的 IS-AT 消息，他将宣布 well-known name 丢失，并生成
一个针对此 well-known name 的 LostAdvertiseName.</p>
<p><img alt="wkn-lost-ip-connectivity" src="../../../../files/learn/system-desc/wkn-lost-ip-connectivity.png" /></p>
<p><strong>Figure:</strong> IP 连接丢失导致的 WKN 丢失</p>
<h4 id="well-known-name">提供方取消推广 well-known name</h4>
<p>下图展示了在提供方应用程序取消了对之前的一个 well-known name 的推广的场景中，AllJoyn 服务 well-known name 的消息序列。</p>
<p><img alt="provider-cancels-wkn-advertisement" src="../../../../files/learn/system-desc/provider-cancels-wkn-advertisement.png" /></p>
<p><strong>Figure:</strong> 提供方取消推广 well-known name</p>
<h5 id="well-known-name_1">使用方取消发现 well-known name</h5>
<p>下图展示了在使用方应用程序取消了对 well-known name 的发现的场景中，AllJoyn 服务 well-known name 的消息序列。</p>
<p><img alt="consumer-cancels-wkn-discovery" src="../../../../files/learn/system-desc/consumer-cancels-wkn-discovery.png" /></p>
<p><strong>Figure:</strong> 使用方取消发现 well-known name</p>
<h4 id="_6">消息结构</h4>
<p>如前所述，Name 服务支持 IS-AT 和 WHO-HAS 消息。这些消息在一个更高层级的 Name 服务消息中被嵌入，将 Name 服务消息可以将 IS-AT 和 WHO-HAS 消息纳入同一个 Name 服务消息中，从而提供了灵活性。当 AllJoyn 应用程序同时作为提供方（推广 well-known name） 和使用方（发现 well-known name）时，这将会非常有用。</p>
<p>下图展示了 Name 服务的消息结构。<a href="#name-service-message-structure-fields">Name Service message structure fields</a> 定义了消息结构字段。</p>
<p><img alt="name-service-message-structure" src="../../../../files/learn/system-desc/name-service-message-structure.png" /></p>
<p><strong>Figure:</strong> Name 服务消息结构</p>
<h5 id="name_1">Name 服务消息结构字段</h5>
<table>
<thead>
<tr>
<th>字段</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sver</td>
<td>发送端最新实现的 AllJoyn 发现协议的版本。</td>
</tr>
<tr>
<td>MVer</td>
<td>Name 服务消息的版本。</td>
</tr>
<tr>
<td>QCount</td>
<td>跟随头文件的 WHO-HAS 问题消息的个数。</td>
</tr>
<tr>
<td>ACount</td>
<td>跟随头文件的 IS-AT 应答消息的个数。</td>
</tr>
<tr>
<td>Timer</td>
<td><p>计算 (以秒计算) 哪些 IS-AT 应答应被认为有效。</p><p>此字段应根据下列参数设定：</p><ul><li>Adv_Validity_Period 被推广的 well-known name 默认的有效期限。</li></ul><ul><li>Adv_Infinite_Validity_Value 指示着一个永久有效的 well-known name 推广，或者至少在被回收前</td>
</tr>
<tr>
<td>有效。如果此项为0，则指示着发送方的 AllJoyn 路由正在回收此推广。</li></ul></td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="is-at_1">IS-AT 消息</h5>
<p>下图展示了 IS-AT 消息的第一版</p>
<p><a href="#is-at-message-format-version-1-fields">IS-AT message format version 1 fields</a>  定义了 IS-AT 消息字段。</p>
<p><img alt="is-at-message-format-v1" src="../../../../files/learn/system-desc/is-at-message-format-v1.png" /></p>
<p><strong>Figure:</strong> IS-AT 消息格式 (版本 1)</p>
<h5 id="is-at-1">IS-AT 消息格式版本 1 字段</h5>
<table>
<thead>
<tr>
<th>字段</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>R4 Bit</td>
<td>如果设置为 '1',  R4 bit 指示着将会呈现一个端点使用 IPv4 （IP 地址和端口号）的可靠传输（TCP）.</td>
</tr>
<tr>
<td>U4 Bit</td>
<td>如果设置为 '1',  U4 bit 指示着将会呈现一个端点使用 IPv4 （IP 地址和端口号）的不可靠传输（UDP）.</td>
</tr>
<tr>
<td>R6 Bit</td>
<td>如果设置为 '1',  R6 bit 指示着将会呈现一个端点使用 IPv6 （IP 地址和端口号）的可靠传输（TCP）.</td>
</tr>
<tr>
<td>U6 Bit</td>
<td>如果设置为 '1',  U4 bit 指示着将会呈现一个端点使用 IPv6 （IP 地址和端口号）的不可靠传输（UDP）.</td>
</tr>
<tr>
<td>C Bit</td>
<td>如果设置为 '1', C bit 指示着 StringData 记录列表是一个由所有被回应方 AllJoyn 路由输出的 well-known names 构成的完整列表。</td>
</tr>
<tr>
<td>G Bit</td>
<td>如果设置为 '1', G bit 指示着将会呈现一个可变长度的 daemon GUID 字符串。</td>
</tr>
<tr>
<td>M</td>
<td>指示 IS-AT 消息的类型。对于 IS-AT，此项被定义为 '01' (1) 。</td>
</tr>
<tr>
<td>Count</td>
<td>IS-AT 消息中所包含的 StringData 项目的个数。</td>
</tr>
<tr>
<td>TransportMask</td>
<td>传送提示符的比特掩码，指示着哪一个 AllJoyn 传输正在执行推送。</td>
</tr>
<tr>
<td>StringData</td>
<td>描述一个正在被推广的 AllJoyn well-known name.</td>
</tr>
</tbody>
</table>
<h5 id="who-has_1">WHO-HAS 消息</h5>
<p>下图展示了 WHO-HAS 消息的第一版</p>
<p><a href="#who-has-message-format-version-1-fields">WHO-HAS message format version 1 fields</a> 定义了 WHO-HAS 消息的字段</p>
<p><img alt="who-has-message-format-v1" src="../../../../files/learn/system-desc/who-has-message-format-v1.png" /></p>
<p><strong>Figure:</strong> WHO-HAS 消息格式 (版本 1)</p>
<h5 id="who-has-1">WHO-HAS 版本 1 消息格式字段</h5>
<table>
<thead>
<tr>
<th>字段</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reserved</td>
<td>保留位</td>
</tr>
<tr>
<td>M</td>
<td>WHO-HAS 消息的类型。  对于 WHO-HAS 此项被定义为 '10' (2) 。</td>
</tr>
<tr>
<td>Count</td>
<td>WHO-HAS 消息中所包含的 StringData 项目的个数。</td>
</tr>
<tr>
<td>StringData</td>
<td>描述使用方 AllJoyn 路由感兴趣的一个 AllJoyn well-known name.</td>
</tr>
</tbody>
</table>
<h3 id="announcement-based">历史版本的 announcement-based 发现</h3>
<p>此章描述了14.06及以前历史版本中关于基于 announcment 的发现的设计。</p>
<p>在基于 announcement 的发现中，提供方设备通过一个 announcment 广播信号来宣布被支持的 AllJoyn 接口。对使用 AllJoyn 服务有兴趣的使用方设备可以
选择接受这些来自提供方的广播 announcement 消息，以发现被支持的 AllJoyn 服务的接口。</p>
<p>Announcment 消息又 About 功能生成，并使用 AllJoyn 路由提供的非会话信号机制（详见 <a href="../../../../learn/core/system-description/sessionless-signal">Sessionless Signal</a>）被当作一个 AllJoyn 非会话信号发送。此非会话信号模型使用 AllJoyn name 服务消息（IS-AT 和 WHO-HAS），和为非会话信号指定格式的 well-known names 对使用方 作出有新信号的提醒。一旦使用方的 AllJoyn 路由发现了此非会话信号的 well-known name, 他将会通过 AllJoyn 会话连接到此提供方，并获取提供方设备
的服务宣布消息。</p>
<p>下图展示了基于 announcement 的发现进程的高层结构。</p>
<p><img alt="announcement-service-discovery-arch" src="../../../../files/learn/system-desc/announcement-service-discovery-arch.png" /></p>
<p><strong>Figure:</strong> 基于 announcement 的服务发现结构</p>
<p>Announcement 消息被作为一个非会话信号从提供方应用程序发送到 AllJoyn 路由，并在非会话信号缓存中被缓存。此非会话信号模块会为非会话信号生成一
个特定格式的 well-known name，如下所示（详见<a href="../../../../learn/core/system-description/sessionless-signal">Sessionless Signal</a>）：</p>
<pre><code>SLS WKN format: org.alljoyn.sl.x&lt;GUID&gt;.x&lt;change_id&gt;
</code></pre>

<p>此非会话信号模块与 Name 服务进行交互，发送给定 well-known name 的 IS-AT 消息。在使用方上的 AllJoyn 路由开始对此 well-known name 进行发现。
根据收到的 IS-AT 消息，在使用方上的非会话信号会通过 AllJoyn 会话连接到提供方的非会话信号模块上，并接收 Announcement 消息，这些 Announcenemt
消息随后会被送至使用方应用程序。</p>
<h4 id="_7">消息序列</h4>
<p>下图展示了基于 Announcement 发现中的消息序列</p>
<p><img alt="announcement-service-discovery" src="../../../../files/learn/system-desc/announcement-service-discovery.png" /></p>
<p><strong>Figure:</strong> 基于 Announcement 发现中的消息序列</p>
<h4 id="announcement">Announcement 消息</h4>
<p>此 Announcement 消息提供一个对象路径的列表，来自被 AllJoyn 应用程序所实现的对象和这些对象支持的接口。此 AllJoyn 应用程序决定在 Announcement
消息中有哪些对象被宣布。</p>
<p>此 Announcementt 消息还包含用于描述应用程序和设备信息的附加 About 字段。详情参见 About HLD. </p>
<h3 id="alljoyn">历史版本的 AllJoyn 发现功能的配置参数</h3>
<p><a href="#alljoyn-discovery-configuration-parameters">AllJoyn discovery configuration parameters</a> 展示了历史 AllJoyn 发现过程中的配置参数。</p>
<p><strong>NOTE:</strong> 具体实现中这些参数可能有不同的名字。</p>
<h4 id="alljoyn_1">AllJoyn 发现配置参数</h4>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>默认值</th>
<th>范围</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>Adv_Validity_Period</td>
<td>120 seconds</td>
<td>TBD</td>
<td>IS-AT 推广的有效时限。</td>
</tr>
<tr>
<td>Adv_Infinite_Validity_Value</td>
<td>255</td>
<td>TBD</td>
<td>此值指示一个永久有效的推广消息。</td>
</tr>
<tr>
<td>Adv_Msg_Retransmit_Interval</td>
<td>40 seconds</td>
<td>TBD</td>
<td>发送 IS-AT 消息的间歇时间（以秒计算）。</td>
</tr>
<tr>
<td>Disc_Msg_Number_Of_Retries</td>
<td>2</td>
<td>TBD</td>
<td>第一次传输之后，WHO-HAS 消息被发送的次数。</td>
</tr>
<tr>
<td>Disc_Msg_Retry_Interval</td>
<td>5 seconds</td>
<td>TBD</td>
<td>重新发送 WHO-HAS 消息的等待时间（以秒计算）。</td>
</tr>
</tbody>
</table>
<h3 id="name_2">下一代 Name 服务</h3>
<p>下一代 Name 服务（NGNS）在14.06之后的版本中被实现，在 AllJoyn 平台提供的发现和 presence 功能方面带来了明显的性能提升，下文有详细说明。</p>
<p>下图展示了 NGNS 的高层结构。</p>
<p><img alt="ngns-high-level-arch" src="../../../../files/learn/system-desc/ngns-high-level-arch.png" /></p>
<p><strong>Figure:</strong> NGNS 高层结构</p>
<p>此结构展示了关于 NGNS 的主要逻辑组件。增强版的发现和 presence 功能通过新的 API 被暴露，并作为 AllJoyn 核心库的一部分。About 功能也被包含在
核心库中，并允许 AllJoyn 应用程序发送 Announcement 非会话信号。非会话信号模块将 Announcement 信号缓存。NGNS 模块使用 Announcement 信号的信
息来应答从使用方应用程序发来的基于接口的发现请求。</p>
<h4 id="_8">发现</h4>
<p>如上文所述，AllJoyn 框架提供基于 name 的发现或基于 announcement 的发现。NGNS 支持下列发现机制：</p>
<ul>
<li>NGNS 支持基于 name 的发现。尽管在 API 层并无变化，此发现机制使用通过 mDNS 的 DNS 服务发现框架。NGNS 根据 AllJoyn 路由中的配置文件发送历史
版本的（14.06以前的版本）发现消息，以实现兼容。 </li>
<li>NGNS 支持一套更有效的基于 announcement 的发现进程，支持使用方应用程序向多个 AllJoyn 接口发送请求。在14.06版本之前，使用方不得不创建匹配规
则以接收所有的 Announce 信号（作为非会话信号被传输），并在作出哪些自己感兴趣的接口被提供的决定之前将提供方应用程序宣布的所有 AllJoyn 接口解
析。此机制虽然比基于 well-known name 的机制更加强大，但不够有效率。NGNS 功能运行一个使用方应用程序向多个 AllJoyn 接口发出请求，只有使用同样
接口的提供方应用程序需要应答。</li>
</ul>
<h4 id="_9">存在检测</h4>
<p>在 14.06 版本以前，存在（或者缺席）检测使用的机制通过由使用方应用程序指定 name （well-known name 或唯一识别符）的三条连续的 IS-AT 消息丢失
来判断的。这种检测所花费的时间是固定的（3*40 sec = 120 sec）.</p>
<p>在 14.06 版本中使用的 NGNS 机制引入了一套更有效率的存在检测机制，此机制由使用方应用程序驱动，并使用了单播消息。一旦 name 已经被发现，使用方
应用程序即可调用新的 Presence API 并判断存在状态。由于每个应用程序在存在检测被触发的时间和事件方面都有自己的逻辑，NGNS 仅仅提供了 API，将具
体的触发逻辑留给应用程序驱动。</p>
<h4 id="ngns">NGNS 设计层面</h4>
<p>下文详细说明了 NGNS 功能的设计层面信息。</p>
<h5 id="mdns">mDNS 的使用</h5>
<p>14.02版本的发现协议是基于通过 AllJoyn 分配的多播 IP 地址发送的 AllJoyn 指定的 UDP 消息的。这种设计限制了可被发现性（IP 路由可能会屏蔽由
ALlJoyn 分配的多播 IP 地址或者/以及端口号）。为了解决该问题，14.06版本的发现协议使用了通过 IANA 分配的多播 IP 地址和端口号发送的 mDNS.</p>
<h5 id="ngns-ip">NGNS 使用的多播 IP 地址和端口号</h5>
<table>
<thead>
<tr>
<th>地址</th>
<th>值</th>
</tr>
</thead>
<tbody>
<tr>
<td>IPv4 多播组播地址</td>
<td>224.0.0.251</td>
</tr>
<tr>
<td>IPv6 多播组播地址</td>
<td>FF02::FB</td>
</tr>
<tr>
<td>多播端口号</td>
<td>5353</td>
</tr>
</tbody>
</table>
<p>此外，mDNS 已经支持以下被 AllJoyn 发现协议所使用的功能：</p>
<ul>
<li>征求单播响应</li>
<li>使用单播发送请求消息</li>
<li>回应方发送主动相应</li>
</ul>
<p>这些功能构成了发现协议的第二版本。版本号被写在 "sender-info" 文本记录 中的 pv 字段，位于 mDNS 请求和应答的附加章节中。</p>
<p><strong>NOTE:</strong> 14.02 Name 服务实现使用了发现协议的第0版和第1版。</p>
<h5 id="dns-sd">DNS-SD 的使用</h5>
<p>14.06 版本的设计是基于 <a href="http://tools.ietf.org/html/rfc6763">RFC 6763</a>. </p>
<p>客户端使用一个对 DNSPTR 记录的请求来完成对一个给定服务 name（与在 IANA 注册的相同，例如 AllJoyn 就是一个已注册的服务名）的可用实例列表 的发现，此 name 有如下格式：</p>
<pre><code>&quot;&lt;Service&gt;.&lt;Domain&gt;&quot; [RFC 1035](https://www.ietf.org/rfc/rfc1035.txt). 
</code></pre>

<p>对于 name "<Service>.<Domain>" 的 PTR查找结果是一系类的0，或者是多个有以下形式的 Service Instance Names 的 PTR 记录：</p>
<pre><code>Service Instance Name = &lt;Instance&gt;.&lt;Service&gt;.&lt;Domain&gt;
</code></pre>

<p>此外，对于此服务实例，DNS-SD 回应方发送 DNA SRV <a href="https://www.ietf.org/rfc/rfc2782.txt">RFC 2782</a>和 DNS TXT <a href="https://www.ietf.org/rfc/rfc1035.txt">RFC 1035</a> 记录。SRV 和 TXT 记录都有以下形式的名字：</p>
<pre><code>&quot;&lt;Instance&gt;.&lt;Service&gt;.&lt;Domain&gt;&quot;
</code></pre>

<p>SRV 记录给出了服务实例可以到达的目标主机和端口号。有同样名字的 DNS TXT 记录给出了此实例的详细信息，在一个使用 key/value 对儿的结构中。</p>
<p>除了在 <a href="http://tools.ietf.org/html/rfc6763">RFC 6763</a> 中指定的服务发现框架中，NGNS 发现协议还在 DNS-SD 请求的附加部分中发送 DNS TXT 记录，
优化了发现范围，而无需通过建立与提供方应用程序的 AllJoyn 会话完成的进一步协商。其他用例中也用了同样的功能，例如发送发送者信息，或者与存在
有关的信息。DNS-SD 消息的细节描述请参见：<a href="#dns-sd-message-format">DNS-SD message format</a>.</p>
<h5 id="wi-fi">用于 Wi-Fi 的设计中的考虑</h5>
<p>众所周知，通过 Wi-Fi 多播的成功率还有待改善，在某些情况中甚至更糟。根据 Wi-Fi 的规范，每一个站点都被允许周期性的进入睡眠状态和唤醒。唤醒的周期由设备提供，应该是 AP 使用的协调多播流量时间区间的因数。</p>
<p>AP 会将收到的多播数据缓存，并根据由 DTIM （Delivery Traffic Indication Message） 决定的时间区间来安排这些数据的发送。在现实中，根据观察，唤醒区间会被设置为 DTIM 值（常常是1,3或10） 的倍数。这样的实现方式使设备有可能
错过多播数据。由于这是一个真实的场景，AllJoyn 发现的协议的设计使用了稳健的方式来处理问题。</p>
<p>具体的，被使用的设计准则如下文描述。</p>
<h6 id="_10">传送计划</h6>
<p>此多播方案为在多个 DTIM 区间中唤醒并处理多播包的设备提供支持。尽管此方案是指数后退的，每一条消息都会被重复两遍，以提升在每三个 DTIM 区
间唤醒一次（很典型的例子）的设备上的多播消息的可靠性。</p>
<p>此方案在下列时间点发送请求消息：0, 1, 3, 9, 和 27 秒。每一次传输触发时，一共有三条消息（原始消息和两条分隔100毫秒的重复）被发送。这种
模式在呼叫流程图中被称为 burst. 就消息接收方而言，他只需要对 burst 中第一个成功接收到的消息发送回复，余下的消息将被忽略。</p>
<h6 id="_11">最小多播与最大单播传输</h6>
<p>这里考虑另一个设计层面：使用多播消息来初始化请求，但使用单播来完成回复以及存在检测。DNS 允许 mDNS 请求中的单播回应被请求，发现协议使用
了此功能。在 DNS 消息头文件的 qclass 字段的首位上有关于此功能的标识 <a href="http://tools.ietf.org/html/rfc6762">RFC 6762</a>.</p>
<h5 id="api">发现并呈现 API 快照</h5>
<p><a href="#discovery-and-presence-apis-related-to-discovery-scenarios">Discovery and Presence APIs related to discovery scenarios</a> 列出了 AllJoyn 系统提供的发现与呈现 APIs 的功能
并将它们映射到了发现场景中。主要的范例是由使用方应用程序主导的发现和呈现功能。</p>
<h5 id="api_1">与发现场景有关的发现并呈现 API 功能</h5>
<table>
<thead>
<tr>
<th>发现场景</th>
<th>API</th>
</tr>
</thead>
<tbody>
<tr>
<td>使用方应用程序请求 Name</td>
<td><code>FindAdvertisedName()</code></td>
</tr>
<tr>
<td>使用方应用程序收到推广名发现或丢失的通知</td>
<td><ul><li><code>FoundAdvertisedName()</code></li><li><code>LostAdvertisedName()</code></li></ul></td>
</tr>
<tr>
<td>使用方应用程序取消了 Name 请求</td>
<td><code>CancelFindAdvertisedName()</code></td>
</tr>
<tr>
<td>提供方应用程序推广 Name</td>
<td><code>AdvertiseName()</code></td>
</tr>
<tr>
<td>提供方应用程序取消了 Name 推广</td>
<td><code>CancelAdvertiseName()</code></td>
</tr>
<tr>
<td>提供方应用程序发送一个 Announcement 消息</td>
<td><code>Announce()</code></td>
</tr>
<tr>
<td>使用方应用程序请求一系列的接口</td>
<td><code>RegisterAnnounceHandler()</code></td>
</tr>
<tr>
<td>使用方应用程序取消对一系列的接口的请求</td>
<td><code>UnregisterAnnounceHandler()</code></td>
</tr>
<tr>
<td>使用方应用程序探测对方是否存在</td>
<td><code>Ping()</code></td>
</tr>
</tbody>
</table>
<h6 id="dns-sd-api">触发 DNS-SD 多播消息的 API 发现。</h6>
<p>一些发现场景会触发多播消息。触发多播消息的 API 包括：<code>FindAdvertisedName()</code>, <code>CancelAdvertiseName()</code>, <code>AdvertiseName()</code>, <code>Announce()</code>, 和 <code>RegisterAnnounceHandler()</code>.</p>
<p>一些多播传输的关键方面在下文列出。</p>
<ul>
<li>通过 mDNS 多播的 mDNS 请求。</li>
<li>根据 <a href="#transmission-schedule">Transmission schedule</a> 的传输方案。</li>
<li>根据在路由的配置文件中设置的 LegacyNS 旗发送 Name 服务消息。</li>
<li>历史版本 Name 服务中跟随同一传送方案的 WHO-HAS 和 mDNS 消息。</li>
</ul>
<h5 id="_12">向下兼容性</h5>
<p>NGNS 在设计中包括了向下兼容的要求：</p>
<ul>
<li>支持所有现存的 14.02 APIs</li>
<li>支持所有历史版本的 (版本 0 和 1) NS 发现包格式。 </li>
<li>在任何有 DNS-SD 消息被发送的时候都发送一个等价的 14.02 发现消息 (带有设定为 true 的LegacyNS 标识)。</li>
<li>在请求消息的所支持版本（SVer）字段中指示此请求不支持 NGNS 的情况下，使用14.02版本的消息进行回应。如果请求方在所支持版本中声明了对 NGNS 的支持，NGNS 则会等待 DNS-SD 消息的到来。</li>
</ul>
<p>AllJoyn 路由配置文件也添加了一项 LegacyNS 标识，以实现发现老版本的功能。Legacy 行为是默认使用的。</p>
<h3 id="ngns_1">NGNS 消息序列</h3>
<p>此部分捕捉了 NGNS 的消息序列。</p>
<h4 id="name_3">基于 name的发现</h4>
<p>此部分描述了 NGNS 基于 name 发现的场景中的消息序列。</p>
<h5 id="ngns_2">NGNS 使用方应用程序和提供方应用程序</h5>
<p>在这一场景中，使用方应用程序的 AllJoyn 路由禁用了历史版本行为的功能，因此使用方应用程序不会发出 Name Service 消息。</p>
<p>这里的消息序列假定提供方的应用程序已经处在 AllJoyn 网络上。</p>
<p>消息序列的几个主要步骤的描述如下。</p>
<ol>
<li>使用方应用程序通过调用 FindAdvertisedName() 来初始化消息流。</li>
<li>NGNS 通过 mDNS 发送基于 DNS-SD 的请求消息。</li>
<li>任何与被搜索的 name 匹配的提供方应用程序将会通过 DNS-SD，以单播的形式向使用方应用程序回复消息。</li>
</ol>
<p><img alt="ngns-discovery-consumer-app-provider" src="../../../../files/learn/system-desc/ngns-discovery-consumer-app-provider.png" /></p>
<p><strong>Figure:</strong> NGNS 基于 name 的发现</p>
<h5 id="ngns-ngns">NGNS 使用方应用程序与 NGNS 提供方应用程序</h5>
<p>此消息序列作出以下假设：</p>
<ul>
<li>使用方应用程序的 AllJoyn 路由已经开启了历史版本 Name 服务行为模式。</li>
<li>提供方应用程序已经连接到 AllJoyn 网络。</li>
</ul>
<p>消息序列的主要步骤如下所述：</p>
<ol>
<li>使用方应用程序通过调用 FindAdvertisedName() 来初始化消息流。</li>
<li>NGNS 通过 mDNS 发送基于 DNS-SD 的请求消息，同时也发送历史版本的 WHO-HAS 消息。</li>
<li>任何与被搜索的 name 匹配的提供方应用程序将会通过 DNS-SD，以单播的形式向使用方应用程序回复消息。</li>
<li>与 WHO-HAS 中的 name 相匹配的任何历史版本的提供方 (14.02版本) 也会通过一个 IS-AT 消息发出回应。</li>
</ol>
<p><img alt="ngns-discovery-ngns-name-service-provider-apps" src="../../../../files/learn/system-desc/ngns-discovery-ngns-name-service-provider-apps.png" /></p>
<p><strong>Figure:</strong> NGNS 基于 name 的发现 (NGNS 以及 Name 服务的提供方应用程序)</p>
<h5 id="findadvertisedname">FindAdvertisedName 挂起; 提供方应用程序迟到</h5>
<p>此消息序列作出以下假设：</p>
<ul>
<li>使用方应用程序的 AllJoyn 路由已经开启了历史版本 Name 服务行为模式。</li>
<li>发起请求的时刻，提供方应用程序未连接到 AllJoyn 网络。</li>
</ul>
<p>消息序列的主要步骤如下所述：</p>
<ol>
<li>使用方应用程序通过调用 FindAdvertisedName() 来初始化消息流。</li>
<li>NGNS 通过 mDNS 发送基于 DNS-SD 的请求消息，同时也发送历史版本的 WHO-HAS 消息。</li>
<li>mDNS 消息和 WHO-HAS 消息的请求调度已过期。</li>
<li>在加入 AllJoyn 网络时，NGNS 提供方应用程序通过 IS-AT 消息发出主动的 DNS-SD 回应消息并推</li>
<li>在加入 AllJoyn 网络时, name 服务提供方应用程序发送 IS-AT 消息。</li>
<li>使用方 AllJoyn 路由执行以下任务：</li>
<li>使用 Name 服务以及 NGNS 消息。</li>
<li>过滤出被推广的 names.</li>
<li>如有匹配成功，则发出 <code>FoundAdvertisedName()</code> 消息。</li>
</ol>
<p><img alt="find-advertised-name-api-called-provider-arrives-later" src="../../../../files/learn/system-desc/find-advertised-name-api-called-provider-arrives-later.png" /></p>
<p><strong>Figure:</strong> FindAdvertisedName API 被调用; 提供方迟到</p>
<h4 id="_13">发现接口名</h4>
<h5 id="ngns-ngns_1">NGNS 使用方应用程序和 NGNS 提供方应用程序</h5>
<p>此消息序列作出以下假设：</p>
<ul>
<li>提供方应用程序已经连接到 AllJoyn 网络。</li>
<li>使用方应用程序的 AllJoyn 路由关闭了历史版本 Name 服务行为模式。</li>
</ul>
<p>消息序列的主要步骤如下所述：</p>
<ol>
<li>使用方应用程序通过注册 announce handler（调用 RegisterAnnounceHandler ）来初始化消息流。这将触发实现了那些接口的提供方的发现进程。</li>
<li>NGNS 通过 mDNS 发送基于 DNS-SD 的请求消息，并根据被发现的 AllJoyn 接口，将搜索 TXT 记录放置在附加的区域中。</li>
<li>任何提供了被发现的 AllJoyn 接口的 AllJoyn 提供方应用程序都要发送 DNS-SD 消息作出回应，并将与 Abount Announce 信号相对应的 well-known name 非会话信号包括在内。
   注意，此消息将通过单播发送。</li>
<li>使用方应用程序即刻初始化一个用于接收并取回 Announce 信号的非会话信号。</li>
</ol>
<p><img alt="alljoyn-interface-query-ngns-consumer-provider-apps" src="../../../../files/learn/system-desc/alljoyn-interface-query-ngns-consumer-provider-apps.png" /></p>
<p><strong>Figure:</strong> AllJoyn 接口请求 (NGNS 使用方应用程序和 NGNS 提供方应用程序)</p>
<h5 id="ngns_3">NGNS 使用方和提供方应用程序</h5>
<p>此消息序列作为呼叫流程的一个延伸 <a href="#ngns-consumer-app-and-ngns-provider-app">NGNS consumer app and NGNS provider app</a>，并伴随着历史版本 Name 服务模
式开启。</p>
<p>尽管基于接口的请求是一个14.06版本的功能，她还是在设计中加入了可以使历史版本 Name 服务提供方应用程序可以加入到发现进程的功能。通过发送
WKN=org.alljoyn.sl 的 WHO-HAS 消息可以开启此功能。</p>
<p>此消息序列假设提供方应用程序已经连接到 AllJoyn 网络。</p>
<p>消息序列的主要步骤如下所述：</p>
<ol>
<li>使用方应用程序通过注册 announce handler（调用 RegisterAnnounceHandler ），并提供一系列用于发现的 AllJoyn 接口来初始化消息流。</li>
<li>NGNS 通过 mDNS 发送基于 DNS-SD 的请求消息，并根据被发现的 AllJoyn 接口，将搜索 TXT 记录放置在附加的区域中。</li>
<li>NGNS 发送 WKN=org.alljoyn.sl 的 WHO-HAS 发现消息。</li>
<li>任何提供了被发现的 AllJoyn 接口的 AllJoyn 提供方应用程序都要发送 DNS-SD 消息作出回应，并将与 Abount Announce 信号相对应的 well-known name 非会话信号包括在内。
   注意，此消息将通过单播发送。</li>
<li>使用方应用程序即刻初始化一个用于接收并取回 Announce 信号的非会话信号。</li>
<li>若非会话信号缓存中存在非会话信号，任何历史版本的提供方应用程序都会发送一条带有非会话信号 well-known name 的 IS-AT 消息。</li>
<li>使用方应用程序即刻初始化一个用于接收并取回提供 AllJoyn 被发现的接口的 Announce 信号的非会话信号。</li>
</ol>
<p><img alt="interface-query-ngns-consumer-app-ngns-ns-provider-apps" src="../../../../files/learn/system-desc/interface-query-ngns-consumer-app-ngns-ns-provider-apps.png" /></p>
<p><strong>Figure:</strong> 接口请求 (NGNS 使用方应用程序和 NGNS 提供方应用程序)</p>
<h5 id="alljoyn-name">AllJoyn 接口 Name 请求被挂起; 提供方应用程序迟到</h5>
<p>此消息序列描述一个请求被挂起的场景（例如，传输已经过期，但 Announce 信号处理程序仍被注册。）</p>
<p>此消息序列的主要步骤如下所述:</p>
<ol>
<li>使用方应用程序通过注册 announce handler（调用 RegisterAnnounceHandler），并提供一系列用于发现的 AllJoyn 接口。</li>
<li>NGNS 通过 mDNS 发送基于 DNS-SD 的请求消息，并根据被发现的 AllJoyn 接口，将搜索 TXT 记录放置在附加的区域中。</li>
<li>NGNS 发送 WKN=org.alljoyn.sl 的 WHO-HAS 发现消息。</li>
<li>mDNS 消息和 WHO-HAS 消息的请求调度已过期。</li>
<li>在提供方应用程序到达 AllJoyn 网络时，NGNS 使用 IS-AT 消息发送带有非会话信号 well-known names 的主动 DNS-SD 回应消息。</li>
<li>在加入 AllJoyn 网络时，Name 服务提供方应用程序通过 IS-AT 消息推广非会话信号的 well-known names.</li>
<li>使用方 AllJoyn 路由器从提供方应用程序接收此非会话信号，并执行过滤操作；如果发现匹配则发送 Announce 信号到使用方应用程序。</li>
</ol>
<p><img alt="pending-interface-query-ngns-consumer-app-ngns-ns-provider-apps" src="../../../../files/learn/system-desc/pending-interface-query-ngns-consumer-app-ngns-ns-provider-apps.png" /></p>
<p><strong>Figure:</strong> 挂起 AllJoyn 接口请求 (NGNS consumer app, NGNS and Name Service provider apps)</p>
<h4 id="_14">取消推广</h4>
<h5 id="ngns-ngns-name">NGNS 提供方应用程序, NGNS 以及 Name 服务的使用方应用程序</h5>
<p>此消息序列的主要步骤如下所示：</p>
<ol>
<li>使用方应用程序调用 CancelAdvertiseName().</li>
<li>NGNS 发送 IS-AT 和 DNS-SD 回应消息。 
mDNS 消息中的 TXT 记录已将 TTL 设定为 0.</li>
<li>使用方应用程序在接收到取消推广发现消息之后立即收到 LostAdvertisedName().</li>
</ol>
<p><img alt="cancel-advertised-name-ngns-consumer-app-ngns-ns-provider-apps" src="../../../../files/learn/system-desc/cancel-advertised-name-ngns-consumer-app-ngns-ns-provider-apps.png" /></p>
<p><strong>Figure:</strong> 取消推广 Name (NGNS 使用方应用程序, NGNS 以及 Name 服务提供方应用程序)</p>
<h4 id="_15">存在</h4>
<h5 id="ngns-ngns_2">NGNS 使用方应用程序以及 NGNS 提供方应用程序</h5>
<p>这里支持两种 Presence API: 同步模式和非同步模式。从有线协议的角度来看，这两种模式的参数序列是相同的。</p>
<p>在14.02版本中，存在检测是通过接收给定 name 的 IS-AT 消息收据来完成的；连续丢失的三个 IS-AT 消息会触发使用方应用程序上的 LostAdvertisedName(). 由于大多数应用程序都是不能容忍延迟存在的，存在检测功能在14.06版本中被重新设计。使用方应用程序可以使用新引入的 Ping API 对一个之前发现过的 name 初始化一个存在检测。</p>
<ul>
<li>如果被发现的 name 被连接到一个 14.06 AllJoyn 路由，则会初始化一个存在检测消息序列。</li>
<li>如果被发现的 name 被连接到一个 14.02 AllJoyn 路由，API 的调用将返回一个错误。</li>
</ul>
<p>此消息序列的主要步骤如下所述。
1. 使用方应用程序通过调用 Ping API 来初始化对一个 name 的存在检测。
2. 在发现时，如果被 ping 的 name 被连接到 14.02版本 AllJoyn 路由，此路由将会返回一个未实现错误代码；其他情况下，消息序列继续。
3. 如果在 AllJoyn 路由表中发生了该 name 的进入，mDNS 消息将被通过单播发送，以检测存在状态。
4. AllJoyn 路由在接收到 mDNS 消息后，立即检测该 name 的存在状态，并通过单播发送一个 mDNS 回应消息。存在检测调用了 D-Bus Ping 方法。</p>
<p><img alt="ping-api-over-ngns-ngns-consumer-provider-apps" src="../../../../files/learn/system-desc/ping-api-over-ngns-ngns-consumer-provider-apps.png" /></p>
<p><strong>Figure:</strong> 使用方应用程序通过 NGNS 调用 Ping API (NGNS 使用方应用程序以及 NGNS 开发方应用程序)</p>
<h5 id="ngns-name">NGNS 使用方应用程序和 Name 服务提供方应用程序的历史版本的存在检测</h5>
<p>如果被发现的 name 被连接到 14.02 版本的 AllJoyn 路由，将不会支持新引入的 Ping API 消息序列。如果 Ping API 返回了未实现错误代码，此使用
方应用程序必须提供带有被发现 name 的 <code>FindAdvertisedName()</code>，以便初始化针对此 name 的存在检测。 </p>
<p><img alt="revert-legacy-presence-ngns-consumer-app-ns-provider-app" src="../../../../files/learn/system-desc/revert-legacy-presence-ngns-consumer-app-ns-provider-app.png" /></p>
<p><strong>Figure:</strong> 转换到历史版本的存在检测 (NGNS 使用方应用程序和 Name Service 提供方应用程序)。</p>
<h3 id="dns-sd_1">DNS-SD 消息格式</h3>
<p>关于 AllJoyn 框架使用 DNS-SD 协议的据图信息，参见 <a href="#usage-of-dns-sd">Usage of DNS-SD </a>. AllJoyn 发现过程是基于 DNS-SD 的，消息格式如下：</p>
<p><strong>NOTE:</strong> 源文件记录中的 <guid> 指 AllJoyn router'\'s GUID. 另外，在一条给定消息中的一个特定记录的存在是被声明与 NGNS 消息序列中的。下
方列表展示了可以被呈现在请求或回应消息中的所有可能的记录类型：</p>
<h4 id="dns-sd_2">DNS-SD 请求</h4>
<h5 id="dns-sd_3">DNS-SD 请求: 问题格式</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th align="center">类型</th>
<th>记录中的数据</th>
</tr>
</thead>
<tbody>
<tr>
<td><ul><li>alljoyn._udp.local.</li><li>alljoyn._tcp.local.</li></ul></td>
<td align="center">PTR</td>
<td><p>服务名是 AllJoyn，由 IANA 分配。</p><p>在 14.06 版本 版本中使用了 TCP 作为服务描述协议。当未来支持 UDP 传输时，此协议将会是 UDP 的。</p><p>发现的范围限于本地网络。</td>
</tr>
</tbody>
</table>
<h5 id="dns-sd_4">DNS-SD 请求: 附加部分</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th align="center">类型</th>
<th>记录中的数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>search.<guid>.local.</td>
<td align="center">TXT</td>
<td><p>捕捉被搜索的 well-known names 或接口。核心概念如下所示： </p><ul><li>txtvrs=0; 这代表了 TXT 的版本。 </li><li>n_1, n_2, etc., 如果有多个 well-known names 呈现，在逻辑上他们将会被执行 AND 运算; n_# 是 well-known names 的 key.</li><li>i_1, i_2, etc., 如有多个接口名被请求，或多个接口名被呈现，在逻辑上他们会被执行 AND 运算；i_# 是接口名的keys</li><li>由于</td>
</tr>
<tr>
<td>基于 name 的请求和基于接口的请求两者的 API 不一样，搜索记录将会记录 name keys 或者接口 keys. </li></ul><p>如果使用方应用程序打算执行</td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td>接口名的逻辑 OR 操作，必须使用接口名和次数调用发现 API.</p><p>Example:  i_1 = org.alljoyn.About</p></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td>sender-info.<guid>.local.</td>
<td align="center">TXT</td>
<td><p>捕捉了指示消息发送方的附加数据。下面列出的 keys 会被发送：</p><ul><li>txtvrs=0; 这代表了 TXT 的版本。</li><li>pv (protocol version):  代表发现协议的编号 </li><li>IPv4 and UDPv4 address: 代表 IPv4 地址及 UDP 端口号。</li><li>bid (burst identifier): 代表 burst 识别符.</li></ul></td>
</tr>
<tr>
<td>ping.<guid>.local.</td>
<td align="center">TXT</td>
<td><p>代表被使用方应用程序调用的 names.关键符号如下：</p><ul><li>txtvrs=0; 这代表了 TXT 的版本。</li><li>n=  well-known name 或唯一识别。.</li></ul><p>Only 在 ping 记录中，key 可以被呈现 </p></td>
</tr>
</tbody>
</table>
<h4 id="dns-sd_5">DNS-SD 回应</h4>
<h5 id="dns-sd_6">DNS-SD 回应消息: 回答部分：</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th align="center">类型</th>
<th>记录中的数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>_alljoyn._tcp.local.</td>
<td align="center">PTR</td>
<td><guid>._alljoyn._tcp.local.</td>
</tr>
<tr>
<td><guid>._alljoyn._tcp.local.</td>
<td align="center">TXT</td>
<td><p>txtvrs=0</p><p>除文本记录版本外，不存在附加记录。</p></td>
</tr>
<tr>
<td><guid>._alljoyn._tcp.local.</td>
<td align="center">SRV</td>
<td><p>port, <guid>.local</p><p>port 代表用于路由之间连接的 TCP 端口号。</p></td>
</tr>
</tbody>
</table>
<h5 id="dns-sd_7">DNS-SD 回应消息: 附加部分</h5>
<table>
<thead>
<tr>
<th>Name</th>
<th align="center">类型</th>
<th>记录中的数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>advertise.<guid>.local.</td>
<td align="center">TXT</td>
<td><p>捕捉提供方应用程序正在推广的 well-known names. 关键符号如下所示：</p><p>n_1, n_2, etc., 如果有多</td>
</tr>
<tr>
<td>个 well-known names 正在被推广; n_# 是 well-known names 的 key.</p><p>对于接口请求的响应, 被推广的非会话信号 well-known name 如下所示:</p><p>n_1=org.alljoyn.About.sl.y<guid>.x<latest change_id></p></td>
<td align="center"></td>
<td></td>
</tr>
<tr>
<td>sender-info.<guid>.local.</td>
<td align="center">TXT</td>
<td><p>捕捉了指示消息发送方的附加数据，下列 keys 将被发送: </p><ul><li>txtvrs=0; 这代表了 TXT 的版本。</li><li>pv (protocol version):  代表发现协议的编号。</li><li>IPv4 and UDPv4 address: 代表 IPv4 和 UDP 端口号。</li><li>bid (burst identifier): 代表 burst 指示符。</li></ul></td>
</tr>
<tr>
<td>Ping-reply.<guid>.local.</td>
<td align="center">TXT</td>
<td><p>捕捉正在被使用方应用程序 ping 的 names. 关键概念如下：</p><ul><li>txtvrs=0; 这代表了 TXT 的版本。</li><li>n= well-known name or unique name.</li><li>replycode = 路由发回去的返回代码。</li></ul></td>
</tr>
<tr>
<td><guid>.local</td>
<td align="center">A</td>
<td>此资源记录发送 IPv4 address. 由应答消息这种方式被呈现。</td>
</tr>
</tbody>
</table>
<h4 id="ngns_4">NGNS</h4>
<table>
<thead>
<tr>
<th>参数</th>
<th>默认</th>
<th>范围</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>EnableLegacyNS</td>
<td>true</td>
<td>boolean</td>
<td>声明相对于历史版本 Name 服务的向后兼容性。</td>
</tr>
</tbody>
</table>
<h3 id="discovery">Discovery 使用指南</h3>
<p>尽管 AllJoyn 系统对基于 Name 和基于 Announcement 的发现都有支持，在 AllJoyn IoE 网络中发现服务的方式还是偏好并推荐基于 Announcement 的发现方式。</p>
<p>基于 Name 的发现过程可被用于应用程序到应用程序的发现，提供方和使用方两方都知晓 well-known names. 这种发现过程也可被用于非会话信号，以
及精简应用程序发现 AllJoyn 路由的过程。</p>
<p><a href="#alljoyn-discovery-method-usage-guidelines">AllJoyn discovery method usage guidelines</a> 
summarizes usage guidelines for the two AllJoyn discovery methods.</p>
<h4 id="alljoyn_2">AllJoyn 发现方法使用指南</h4>
<table>
<thead>
<tr>
<th>使用基于 Name 的发现</th>
<th>使用基于 Announcement 的发现</th>
</tr>
</thead>
<tbody>
<tr>
<td><ul><li>应用程序到应用程序的发现</li><li>非会话信号</li><li>用于精简应用程序的 AllJoyn 路由发现</li></ul></td>
<td>在 AllJoyn 网络上的服务</td>
</tr>
<tr>
<td>接口发现。</td>
<td></td>
</tr>
</tbody>
</table></div>
    <div class="col-md-1"><div class="bs-sidebar hidden-print affix well" role="complementary">
  <ul class="nav bs-sidenav">
    
      <li class="main active"><a href="#_1">推广和发现</a></li>
      
        <li><a href="#_2">概述</a></li>
      
        <li><a href="#name">基于 name 的历史版本发现机制</a></li>
      
        <li><a href="#is-at">IS-AT</a></li>
      
    
  </ul>
</div></div>
  </div>

  <footer class="col-md-12">
    <hr>
    
    <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
  </footer>

  <script src="../../../../js/jquery-1.10.2.min.js"></script>
  <script src="../../../../js/bootstrap-3.0.3.min.js"></script>
  <script src="../../../../js/highlight.pack.js"></script>
  <script src="../../../../js/base.js"></script>
</body>
</html>